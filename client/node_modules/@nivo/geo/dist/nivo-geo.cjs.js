"use strict";var e=require("react"),r=require("@nivo/core"),o=require("@nivo/tooltip"),t=require("prop-types"),i=require("@nivo/colors"),n=require("lodash"),a=require("d3-format"),u=require("d3-geo"),l=require("@nivo/legends"),s=require("react/jsx-runtime");function c(){return c=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},c.apply(this,arguments)}var d={azimuthalEqualArea:u.geoAzimuthalEqualArea,azimuthalEquidistant:u.geoAzimuthalEquidistant,gnomonic:u.geoGnomonic,orthographic:u.geoOrthographic,stereographic:u.geoStereographic,equalEarth:u.geoEqualEarth,equirectangular:u.geoEquirectangular,mercator:u.geoMercator,transverseMercator:u.geoTransverseMercator,naturalEarth1:u.geoNaturalEarth1},p=function(o){var t=o.width,n=o.height,a=o.projectionType,l=o.projectionScale,s=o.projectionTranslation,c=o.projectionRotation,p=o.fillColor,h=o.borderWidth,f=o.borderColor,g=e.useMemo((function(){return d[a]().scale(l).translate([t*s[0],n*s[1]]).rotate(c)}),[t,n,a,l,s[0],s[1],c[0],c[1],c[2]]),v=e.useMemo((function(){return u.geoPath(g)}),[g]),C=e.useMemo((function(){return u.geoGraticule()})),m=r.useTheme(),b=e.useMemo((function(){return"function"==typeof h?h:function(){return h}}),[h]),j=i.useInheritedColor(f,m),y=e.useMemo((function(){return"function"==typeof p?p:function(){return p}}),[p]);return{projection:g,path:v,graticule:C,getBorderWidth:b,getBorderColor:j,getFillColor:y}},h=function(o){var t=o.features,i=o.data,u=o.match,s=o.label,d=o.value,p=o.valueFormat,h=o.colors,f=o.unknownColor,g=o.domain,v=e.useMemo((function(){return n.isFunction(u)?u:function(e,r){var o=n.get(e,u),t=n.get(r,u);return o&&o===t}}),[u]),C=e.useMemo((function(){return n.isFunction(s)?s:function(e){return n.get(e,s)}}),[s]),m=e.useMemo((function(){return n.isFunction(d)?d:function(e){return n.get(e,d)}}),[d]),b=e.useMemo((function(){return void 0===p?function(e){return e}:n.isFunction(p)?p:a.format(p)}),[p]),j=e.useMemo((function(){return r.guessQuantizeColorScale(h).domain(g)}),[h,g]),y=e.useMemo((function(){return function(e){return void 0===e.value?f:j(e.value)}}),[j,f]),R=e.useMemo((function(){return t.map((function(e){var r=i.find((function(r){return v(e,r)})),o=m(r);if(r){var t=c({},e,{data:r,value:o,formattedValue:b(o)});return t.color=y(t),t.label=C(t),t}return e}))}),[t,i,v,m,b,y]),q=l.useQuantizeColorScaleLegendData({scale:j,valueFormat:b});return{colorScale:j,getFillColor:y,boundFeatures:R,valueFormatter:b,legendData:q}},f=e.memo((function(e){var r=e.feature;return void 0===r.data?null:s.jsx(o.BasicTooltip,{id:r.label,color:r.color,enableChip:!0,value:r.formattedValue})}));f.propTypes={feature:t.object.isRequired},f.displayName="ChoroplethTooltip";var g={features:t.arrayOf(t.shape({id:t.string.isRequired,type:t.oneOf(["Feature"]).isRequired,properties:t.object,geometry:t.object.isRequired})).isRequired,projectionType:t.oneOf(Object.keys(d)).isRequired,projectionScale:t.number.isRequired,projectionTranslation:t.arrayOf(t.number).isRequired,projectionRotation:t.arrayOf(t.number).isRequired,fillColor:t.oneOfType([t.string,t.func]).isRequired,borderWidth:t.oneOfType([t.number,t.func]).isRequired,borderColor:i.inheritedColorPropType.isRequired,enableGraticule:t.bool.isRequired,graticuleLineWidth:t.number.isRequired,graticuleLineColor:t.string.isRequired,isInteractive:t.bool.isRequired,onMouseEnter:t.func.isRequired,onMouseMove:t.func.isRequired,onMouseLeave:t.func.isRequired,onClick:t.func.isRequired,tooltip:t.any,layers:t.arrayOf(t.oneOfType([t.oneOf(["graticule","features"]),t.func])).isRequired},v=c({},g,{role:t.string.isRequired}),C=c({pixelRatio:t.number.isRequired},g),m={data:t.arrayOf(t.object).isRequired,match:t.oneOfType([t.string,t.func]).isRequired,label:t.oneOfType([t.string,t.func]).isRequired,value:t.oneOfType([t.string,t.func]).isRequired,valueFormat:t.oneOfType([t.string,t.func]),colors:r.quantizeColorScalePropType.isRequired,domain:t.arrayOf(t.number).isRequired,unknownColor:t.string.isRequired,layers:t.arrayOf(t.oneOfType([t.oneOf(["graticule","features","legends"]),t.func])).isRequired},b=c({},v,m,{role:t.string.isRequired}),j=c({},C,m),y={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},R=c({},y,{role:"img"}),q=c({},y,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),M={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:f,layers:["graticule","features","legends"]},T=c({},R,M,{role:"img"}),x=c({},q,M),k=e.memo((function(e){var r=e.path,o=e.graticule,t=e.lineWidth,i=e.lineColor;return s.jsx("path",{fill:"none",strokeWidth:t,stroke:i,d:r(o())})}));k.propTypes={path:t.func.isRequired,graticule:t.func.isRequired,lineWidth:t.number.isRequired,lineColor:t.string.isRequired},k.displayName="GeoGraticule";var W=e.memo((function(e){var r,o=e.feature,t=e.path,i=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,c=e.onMouseMove,d=e.onMouseLeave;return s.jsx("path",{fill:null!=(r=null==o?void 0:o.fill)?r:i,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:t(o),onMouseEnter:function(e){return l(o,e)},onMouseMove:function(e){return c(o,e)},onMouseLeave:function(e){return d(o,e)},onClick:function(e){return u(o,e)}},o.id)}));W.propTypes={feature:t.shape({id:t.string.isRequired,type:t.oneOf(["Feature"]).isRequired,properties:t.object,geometry:t.object.isRequired}).isRequired,path:t.func.isRequired,fillColor:t.string.isRequired,borderWidth:t.number.isRequired,borderColor:t.string.isRequired,onMouseEnter:t.func.isRequired,onMouseMove:t.func.isRequired,onMouseLeave:t.func.isRequired,onClick:t.func.isRequired},W.displayName="GeoMapFeature";var w=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.features,l=t.layers,c=t.projectionType,d=t.projectionScale,h=t.projectionTranslation,f=t.projectionRotation,g=t.fillColor,v=t.borderWidth,C=t.borderColor,m=t.enableGraticule,b=t.graticuleLineWidth,j=t.graticuleLineColor,y=t.isInteractive,R=t.onClick,q=t.tooltip,M=t.role,T=r.useDimensions(i,n,a),x=T.margin,w=T.outerWidth,F=T.outerHeight,E=p({width:i,height:n,projectionType:c,projectionScale:d,projectionTranslation:h,projectionRotation:f,fillColor:g,borderWidth:v,borderColor:C}),S=E.graticule,O=E.path,L=E.getFillColor,G=E.getBorderWidth,P=E.getBorderColor,B=r.useTheme(),D=o.useTooltip(),I=D.showTooltipFromEvent,N=D.hideTooltip,z=e.useCallback((function(e,r){return y&&R&&R(e,r)}),[y,R]),H=e.useCallback((function(e,r){return y&&q&&I(s.jsx(q,{feature:e}),r)}),[y,I,q]),A=e.useCallback((function(e,r){return y&&q&&I(s.jsx(q,{feature:e}),r)}),[y,I,q]),K=e.useCallback((function(){return y&&N()}),[y,N]);return s.jsx(r.SvgWrapper,{width:w,height:F,margin:x,theme:B,role:M,children:l.map((function(r,o){return"graticule"===r?!0!==m?null:s.jsx(k,{path:O,graticule:S,lineWidth:b,lineColor:j},"graticule"):"features"===r?s.jsx(e.Fragment,{children:u.map((function(e){return s.jsx(W,{feature:e,path:O,fillColor:L(e),borderWidth:G(e),borderColor:P(e),onMouseEnter:H,onMouseMove:A,onMouseLeave:K,onClick:z},e.id)}))},"features"):s.jsx(e.Fragment,{children:r(t)},o)}))})}));w.displayName="GeoMap",w.propTypes=v,w.defaultProps=R;var F=r.withContainer(w),E=function(e,o,t,i){var n=r.getRelativeCursor(o,e),a=n[0],l=n[1];return t.find((function(e){return u.geoContains(e,i.invert([a,l]))}))},S=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.pixelRatio,l=t.features,c=t.layers,d=t.projectionType,h=t.projectionScale,f=t.projectionTranslation,g=t.projectionRotation,v=t.fillColor,C=t.borderWidth,m=t.borderColor,b=t.enableGraticule,j=t.graticuleLineWidth,y=t.graticuleLineColor,R=t.isInteractive,q=t.onClick,M=t.onMouseMove,T=t.tooltip,x=e.useRef(null),k=r.useTheme(),W=r.useDimensions(i,n,a),w=W.margin,F=W.outerWidth,S=W.outerHeight,O=p({width:i,height:n,projectionType:d,projectionScale:h,projectionTranslation:f,projectionRotation:g,fillColor:v,borderWidth:C,borderColor:m}),L=O.projection,G=O.graticule,P=O.path,B=O.getFillColor,D=O.getBorderWidth,I=O.getBorderColor;e.useEffect((function(){if(x){x.current.width=F*u,x.current.height=S*u;var e=x.current.getContext("2d");e.scale(u,u),e.fillStyle=k.background,e.fillRect(0,0,F,S),e.translate(w.left,w.top),P.context(e),c.forEach((function(r){"graticule"===r?!0===b&&(e.lineWidth=j,e.strokeStyle=y,e.beginPath(),P(G()),e.stroke()):"features"===r?l.forEach((function(r){e.beginPath(),P(r),e.fillStyle=B(r),e.fill();var o=D(r);o>0&&(e.strokeStyle=I(r),e.lineWidth=o,e.stroke())})):r(e,t)}))}}),[x,F,S,w,u,k,P,G,B,D,I,l,c]);var N=o.useTooltip(),z=N.showTooltipFromEvent,H=N.hideTooltip,A=e.useCallback((function(e){if(R&&T){var r=E(e,x.current,l,L);r?z(s.jsx(T,{feature:r}),e):H(),M&&M(r||null,e)}}),[z,H,R,T,x,l,L]),K=e.useCallback((function(){return R&&H()}),[R,H]),Q=e.useCallback((function(e){if(R&&q){var r=E(e,x.current,l,L);r&&q(r,e)}}),[R,x,l,L,q]);return s.jsx("canvas",{ref:x,width:F*u,height:S*u,style:{width:F,height:S,cursor:R?"auto":"normal"},onMouseMove:A,onMouseLeave:K,onClick:Q})}));S.displatName="GeoMapCanvas",S.propTypes=C,S.defaultProps=q;var O=r.withContainer(S),L=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.features,d=t.data,f=t.match,g=t.label,v=t.value,C=t.valueFormat,m=t.projectionType,b=t.projectionScale,j=t.projectionTranslation,y=t.projectionRotation,R=t.colors,q=t.domain,M=t.unknownColor,x=t.borderWidth,w=t.borderColor,F=t.enableGraticule,E=t.graticuleLineWidth,S=t.graticuleLineColor,O=t.layers,L=t.legends,G=t.isInteractive,P=t.onClick,B=t.tooltip,D=t.role,I=t.defs,N=void 0===I?T.defs:I,z=t.fill,H=void 0===z?T.fill:z,A=r.useDimensions(i,n,a),K=A.margin,Q=A.outerWidth,V=A.outerHeight,J=p({width:i,height:n,projectionType:m,projectionScale:b,projectionTranslation:j,projectionRotation:y,fillColor:function(){},borderWidth:x,borderColor:w}),U=J.graticule,X=J.path,Y=J.getBorderWidth,Z=J.getBorderColor,$=h({features:u,data:d,match:f,label:g,value:v,valueFormat:C,colors:R,unknownColor:M,domain:q}),_=$.getFillColor,ee=$.boundFeatures,re=$.legendData,oe=r.useTheme(),te=r.bindDefs(N,ee,H,{dataKey:"data",targetKey:"fill"}),ie=o.useTooltip(),ne=ie.showTooltipFromEvent,ae=ie.hideTooltip,ue=e.useCallback((function(e,r){return G&&P&&P(e,r)}),[G,P]),le=e.useCallback((function(e,r){return G&&B&&ne(s.jsx(B,{feature:e}),r)}),[G,ne,B]),se=e.useCallback((function(e,r){return G&&B&&ne(s.jsx(B,{feature:e}),r)}),[G,ne,B]),ce=e.useCallback((function(){return G&&ae()}),[G,ae]);return s.jsx(r.SvgWrapper,{width:Q,height:V,margin:K,theme:oe,defs:te,role:D,children:O.map((function(r,o){return"graticule"===r?!0!==F?null:s.jsx(k,{path:X,graticule:U,lineWidth:E,lineColor:S},"graticule"):"features"===r?s.jsx(e.Fragment,{children:ee.map((function(e){return s.jsx(W,{feature:e,path:X,fillColor:_(e),borderWidth:Y(e),borderColor:Z(e),onMouseEnter:le,onMouseMove:se,onMouseLeave:ce,onClick:ue},e.id)}))},"features"):"legends"===r?L.map((function(e,r){return s.jsx(l.BoxLegendSvg,c({containerWidth:i,containerHeight:n,data:re},e),r)})):s.jsx(e.Fragment,{children:r({})},o)}))})}));L.displayName="Choropleth",L.propTypes=b,L.defaultProps=T;var G=r.withContainer(L),P=function(e,o,t,i){var n=r.getRelativeCursor(o,e),a=n[0],l=n[1];return t.find((function(e){return u.geoContains(e,i.invert([a,l]))}))},B=e.memo((function(t){var i=t.width,n=t.height,a=t.margin,u=t.pixelRatio,d=t.features,f=t.data,g=t.match,v=t.label,C=t.value,m=t.valueFormat,b=t.projectionType,j=t.projectionScale,y=t.projectionTranslation,R=t.projectionRotation,q=t.colors,M=t.domain,T=t.unknownColor,x=t.borderWidth,k=t.borderColor,W=t.enableGraticule,w=t.graticuleLineWidth,F=t.graticuleLineColor,E=t.layers,S=t.legends,O=t.isInteractive,L=t.onClick,G=t.onMouseMove,B=t.tooltip,D=e.useRef(null),I=r.useTheme(),N=r.useDimensions(i,n,a),z=N.margin,H=N.outerWidth,A=N.outerHeight,K=p({width:i,height:n,projectionType:b,projectionScale:j,projectionTranslation:y,projectionRotation:R,fillColor:function(){},borderWidth:x,borderColor:k}),Q=K.projection,V=K.graticule,J=K.path,U=K.getBorderWidth,X=K.getBorderColor,Y=h({features:d,data:f,match:g,label:v,value:C,valueFormat:m,colors:q,unknownColor:T,domain:M}),Z=Y.getFillColor,$=Y.boundFeatures,_=Y.legendData;e.useEffect((function(){if(D){D.current.width=H*u,D.current.height=A*u;var e=D.current.getContext("2d");e.scale(u,u),e.fillStyle=I.background,e.fillRect(0,0,H,A),e.translate(z.left,z.top),J.context(e),E.forEach((function(r){"graticule"===r?!0===W&&(e.lineWidth=w,e.strokeStyle=F,e.beginPath(),J(V()),e.stroke()):"features"===r?$.forEach((function(r){e.beginPath(),J(r),e.fillStyle=Z(r),e.fill();var o=U(r);o>0&&(e.strokeStyle=X(r),e.lineWidth=o,e.stroke())})):"legends"===r&&S.forEach((function(r){l.renderLegendToCanvas(e,c({},r,{data:_,containerWidth:i,containerHeight:n,theme:I}))}))}))}}),[D,H,A,z,u,I,J,V,Z,U,X,$,S,E]);var ee=o.useTooltip(),re=ee.showTooltipFromEvent,oe=ee.hideTooltip,te=e.useCallback((function(e){if(O&&B){var r=P(e,D.current,$,Q);r?re(s.jsx(B,{feature:r}),e):oe(),G&&G(r||null,e)}}),[re,oe,O,B,D,$,Q]),ie=e.useCallback((function(){return O&&oe()}),[O,oe]),ne=e.useCallback((function(e){if(O&&L){var r=P(e,D.current,$,Q);r&&L(r,e)}}),[O,D,$,Q,L]);return s.jsx("canvas",{ref:D,width:H*u,height:A*u,style:{width:H,height:A,cursor:O?"auto":"normal"},onMouseMove:te,onMouseLeave:ie,onClick:ne})}));B.displayName="ChoroplethCanvas",B.propTypes=j,B.defaultProps=x;var D=r.withContainer(B);exports.Choropleth=G,exports.ChoroplethCanvas=D,exports.ChoroplethCanvasDefaultProps=x,exports.ChoroplethCanvasPropTypes=j,exports.ChoroplethDefaultProps=T,exports.ChoroplethPropTypes=b,exports.GeoMap=F,exports.GeoMapCanvas=O,exports.GeoMapCanvasDefaultProps=q,exports.GeoMapCanvasPropTypes=C,exports.GeoMapDefaultProps=R,exports.GeoMapPropTypes=v,exports.ResponsiveChoropleth=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return s.jsx(G,c({width:o,height:t},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return s.jsx(D,c({width:o,height:t},e))}})},exports.ResponsiveGeoMap=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return s.jsx(F,c({width:o,height:t},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var o=r.width,t=r.height;return s.jsx(O,c({width:o,height:t},e))}})},exports.projectionById=d,exports.useChoropleth=h,exports.useGeoMap=p;
//# sourceMappingURL=nivo-geo.cjs.js.map
